// js/generators/generator-link/gln-plugins.js
/*
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë                    GENERATOR LINK - PLUGINS                             ‚ïë
 * ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
 * ‚ïë  üîí –Ø–î–†–û ‚Äî –°–∏—Å—Ç–µ–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ç–∞ —Ö—É–∫—ñ–≤                        ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

/**
 * –°–ò–°–¢–ï–ú–ê –ü–õ–ê–ì–Ü–ù–Ü–í LINKS –ì–ï–ù–ï–†–ê–¢–û–†–ê
 *
 * –î–æ–∑–≤–æ–ª—è—î –º–æ–¥—É–ª—è–º —Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è —ñ –±—É—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–∏–º–∏ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫.
 *
 * –•—É–∫–∏ (–ø–æ–¥—ñ—ó):
 * - onInit: –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
 * - onReset: –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö
 */

const hooks = {
    onInit: [],
    onReset: [],
};

/**
 * –†–µ—î—Å—Ç—Ä—É—î –ø–ª–∞–≥—ñ–Ω –¥–ª—è –ø–µ–≤–Ω–æ–≥–æ —Ö—É–∫–∞
 */
export function registerLinksPlugin(hookName, callback, priority = 10) {
    if (!hooks[hookName]) {
        console.warn(`[Links Plugins] –ù–µ–≤—ñ–¥–æ–º–∏–π —Ö—É–∫: ${hookName}`);
        return;
    }

    hooks[hookName].push({ callback, priority });
    hooks[hookName].sort((a, b) => a.priority - b.priority);
}

/**
 * –í–∏–∫–ª–∏–∫–∞—î –≤—Å—ñ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ –¥–ª—è —Ö—É–∫–∞
 */
export function runHook(hookName, ...args) {
    if (!hooks[hookName]) return;

    hooks[hookName].forEach(({ callback }) => {
        try {
            callback(...args);
        } catch (err) {
            console.error(`[Links Plugin Error] ${hookName}:`, err);
        }
    });
}

/**
 * –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ (–¥–ª—è –¥–µ–±–∞–≥—É)
 */
export function getRegisteredPlugins() {
    const result = {};
    for (const [hookName, plugins] of Object.entries(hooks)) {
        result[hookName] = plugins.length;
    }
    return result;
}
