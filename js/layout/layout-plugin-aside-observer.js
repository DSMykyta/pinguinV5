// js/layout/layout-plugin-aside-observer.js

/**
 * â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
 * â•‘            ĞŸĞ ĞĞ’Ğ ĞŸĞĞĞ•Ğ›Ğ¬ â€” Ğ’Ğ†Ğ”Ğ¡Ğ¢Ğ•Ğ–Ğ•ĞĞĞ¯ Ğ¡Ğ•ĞšĞ¦Ğ†Ğ™ (ASIDE OBSERVER)            â•‘
 * â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
 * â•‘                                                                          â•‘
 * â•‘  IntersectionObserver Ñ‰Ğ¾ ÑÑ‚ĞµĞ¶Ğ¸Ñ‚ÑŒ Ğ·Ğ° ÑĞµĞºÑ†Ñ–ÑĞ¼Ğ¸ ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸.                   â•‘
 * â•‘  ĞŸÑ€Ğ¸ ÑĞºÑ€Ğ¾Ğ»Ñ– Ğ´Ğ¾ ÑĞµĞºÑ†Ñ–Ñ— â€” Ğ¿ĞµÑ€ĞµĞ¼Ğ¸ĞºĞ°Ñ” Ğ²Ğ¼Ñ–ÑÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ— Ğ¿Ğ°Ğ½ĞµĞ»Ñ–.                   â•‘
 * â•‘                                                                          â•‘
 * â•‘  ğŸ“‹ ĞĞ¢Ğ Ğ˜Ğ‘Ğ£Ğ¢Ğ˜ Ğ¡Ğ•ĞšĞ¦Ğ†Ğ™:                                                     â•‘
 * â•‘  â”œâ”€â”€ data-aside-template="aside-table" â€” ÑĞºĞ¸Ğ¹ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸            â•‘
 * â•‘  â””â”€â”€ data-aside-template=""            â€” aside Ğ·Ğ°ĞºÑ€Ğ¸Ğ²Ğ°Ñ”Ñ‚ÑŒÑÑ (absent)     â•‘
 * â•‘                                                                          â•‘
 * â•‘  ğŸ“‹ HTML ĞŸĞ Ğ˜ĞšĞ›ĞĞ”:                                                        â•‘
 * â•‘  <main data-aside-template="aside-glossary">          â† Ğ²ÑÑ ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ°    â•‘
 * â•‘  <div class="tab-content" data-aside-template="aside-brands"> â† Ñ‚Ğ°Ğ±     â•‘
 * â•‘  <section data-aside-template="aside-table">          â† ÑĞµĞºÑ†Ñ–Ñ          â•‘
 * â•‘  <section data-aside-template="">                     â† Ğ±ĞµĞ· Ğ¿Ğ°Ğ½ĞµĞ»Ñ–      â•‘
 * â•‘                                                                          â•‘
 * â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

import { showAsidePanel } from './layout-plugin-aside-loader.js';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ĞŸĞ£Ğ‘Ğ›Ğ†Ğ§ĞĞ• API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * ğŸ”Œ ĞŸĞ›ĞĞ“Ğ†Ğ â€” Ğ²Ñ–Ğ´ÑÑ‚ĞµĞ¶ÑƒÑ” ÑĞµĞºÑ†Ñ–Ñ— Ñ‚Ğ° Ğ¿ĞµÑ€ĞµĞ¼Ğ¸ĞºĞ°Ñ” Ğ²Ğ¼Ñ–ÑÑ‚ aside.
 */
export function init() {
    const sections = document.querySelectorAll('[data-aside-template]');
    if (!sections.length) return;

    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (!entry.isIntersecting) return;

            const templateName = entry.target.dataset.asideTemplate;

            // Ğ¢Ñ–Ğ»ÑŒĞºĞ¸ Ğ¼Ñ–Ğ½ÑÑ”Ğ¼Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚, ÑÑ‚Ğ°Ğ½ aside Ğ½Ğµ Ñ‡Ñ–Ğ¿Ğ°Ñ”Ğ¼Ğ¾ â€”
            // ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡ ÑĞ°Ğ¼ ĞºĞµÑ€ÑƒÑ” expanded/collapsed/closed
            showAsidePanel(templateName || null);
        });
    }, {
        root: null,
        threshold: 0.1
    });

    sections.forEach(s => observer.observe(s));
}
