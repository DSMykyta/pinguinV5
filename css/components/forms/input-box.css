/**
 * COMPONENT: Content Line System
 *
 * ПРИЗНАЧЕННЯ:
 * Уніфікована система контейнерів-блоків для будь-якого контенту:
 * інпути, кнопки, текст, іконки, лейбли, каунтери.
 * Замінює: table-row-inputs.css + compound-input.css + panel-box.css + search.css + group-column-result
 *
 * СТРУКТУРА:
 * ┌────────────────────────────────────────────────────────────┐
 * │ .content-bloc-container                                    │
 * │  ┌──────────────────────────────────────────────────────┐  │
 * │  │ .content-bloc                                        │  │
 * │  │  [btn-icon ghost drag]                                │  │
 * │  │  ┌────────────────────────────────────────────────┐  │  │
 * │  │  │ .content-line                                  │  │  │
 * │  │  │  ┌────────────────┐   ┌─────────────────────┐  │  │  │
 * │  │  │  │ .input-box     │ | │ .input-box          │  │  │  │
 * │  │  │  │  [input]       │ . │  [input] [.tag]     │  │  │  │
 * │  │  │  │  .large        │ s │  .small             │  │  │  │
 * │  │  │  └────────────────┘ v └─────────────────────┘  │  │  │
 * │  │  └────────────────────────────────────────────────┘  │  │
 * │  │  [btn-icon] [btn-icon]                               │  │
 * │  └──────────────────────────────────────────────────────┘  │
 * └────────────────────────────────────────────────────────────┘
 *
 * ВАРІАНТИ CONTENT-LINE:
 * - (без класу) — бордер, для таблиць і форм
 * - .panel      — сірий фон, без бордера, більша висота (панелі, пошук, результати)
 *
 * РОЗМІРИ INPUT-BOX:
 * - (без класу) — flex: 1 (мінімальний / 100% якщо один)
 * - .small      — flex: 2 (середній)
 * - .large      — flex: 4 (максимальний)
 *
 * КЛАСИ ВІЗУАЛІЗАЦІЇ (додаються JS на .content-bloc):
 * - .td        — звичайний рядок таблиці
 * - .th        — заголовок (світло-сірий фон)
 * - .th-strong — сильний заголовок (сірий фон, жирний)
 * - .bold      — жирний текст
 * - .italic    — курсив
 * - .h3        — заголовок (ховає малі input-box, без рамки)
 * - .colspan2  — об'єднання колонок (ховає малі input-box)
 * - .single    — одна колонка (ховає малі input-box)
 * - .new-table — розділювач таблиць (невидимий)
 * - .added     — доданий рядок (акцентний колір)
 *
 * ЗАЛЕЖНОСТІ:
 * - root.css (--color-outline, --color-on-surface, --color-main, --color-accent, etc.)
 * - helpers.css (.separator-v)
 */


/* ============================================ */
/* КОНТЕЙНЕР ДЛЯ РЯДКІВ                        */
/* ============================================ */

.content-bloc-container {
    display: flex;
    flex-direction: column;
    gap: 0;
}

/* Варіант з відступами між рядками (для форм) */
.content-bloc-container.spaced {
    gap: 8px;
}

/* Пусте повідомлення */
.content-bloc-container .empty-state-container {
    padding: 24px;
    text-align: center;
    color: var(--color-on-surface-v);
}

.content-bloc-empty {
    padding: 16px;
    text-align: center;
    color: var(--color-on-surface-v);
    background: var(--color-surface-c-low);
    border-radius: var(--radius-xs);
}


/* ============================================ */
/* РЯДОК                                       */
/* ============================================ */

.content-bloc {
    display: flex;
    align-items: center;
    gap: 8px;
}

.content-bloc .material-symbols-outlined {
    font-size: 20px;
}


/* ============================================ */
/* CONTENT-LINE (обрамлений контейнер)         */
/* ============================================ */

.content-line {
    display: flex;
    flex-direction: row;
    align-items: center;
    width: 100%;
    min-height: 42px;
    border: 1px solid var(--color-outline);
    transition: border-radius 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
}

/* Коли є textarea — розтягуємо сусідів по висоті */
.content-line:has(textarea) {
    align-items: stretch;
}

/* Hover/focus для .spaced контейнерів — на кожен content-line окремо */
.content-bloc-container.spaced .content-line:not(.panel):hover {
    border-color: var(--color-on-surface-v);
}

.content-bloc-container.spaced .content-line:not(.panel):focus-within {
    outline: 1px solid var(--color-main);
    outline-offset: -2px;
    border-color: transparent;
}

/* Hover/focus для НЕ-.spaced контейнерів — на весь блок цілком */
.content-bloc-container:not(.spaced):focus-within {
    outline: 1px solid var(--color-main);
    outline-offset: -1px;
    border-radius: 8px;
}

/* Error стан — червоний outline на весь блок */
.content-bloc-container[error] {
    outline: 1px solid var(--color-error);
    outline-offset: -1px;
    border-radius: 8px;
}

/* Drag-and-drop стан */
.content-line.drag-over {
    border-color: var(--color-main);
    background-color: var(--color-main-c);
}


/* ============================================ */
/* PANEL ВАРІАНТ (сірий фон, без бордера)      */
/* ============================================ */

.content-line.panel {
    background: var(--color-surface-c-low);
    border: none;
    border-radius: 8px;
    min-height: 62px;
    padding: 0 12px;
    gap: 12px;
    overflow: hidden;
    transition: background-color 0.2s;
}

.content-line.panel:hover {
    background: var(--color-surface-c);
}

/* Скопійовано — акцентний фон */
.content-line.panel.copied {
    background: color-mix(in srgb, var(--color-main) 20%, transparent);
}

/* Іконка всередині .panel */
.content-line.panel > .material-symbols-outlined {
    font-size: 20px;
    color: var(--color-main);
    flex-shrink: 0;
}

/* Текст всередині .panel */
.content-line.panel .panel-text {
    flex: 1 1 auto;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Мітка (Title:, Keywords: тощо) */
.content-line.panel .panel-label {
    color: var(--color-on-surface-v);
    white-space: nowrap;
    flex-shrink: 0;
}

/* Лічильник символів */
.content-line.panel .panel-counter {
    color: var(--color-on-surface-v);
    white-space: nowrap;
    flex-shrink: 0;
}

/* Input всередині .panel — без бордера, прозорий, на всю ширину */
.content-line.panel > input,
.content-line.panel > .input-box input {
    flex: 1 1 auto;
    min-width: 0;
}


/* ============================================ */
/* INPUT-BOX (прозорий, тримає input + stuff)  */
/* ============================================ */

.input-box {
    display: flex;
    align-items: center;
    flex: 1;
    padding: 0 8px;
}

.input-box.large {
    flex: 4;
}

.input-box.small {
    flex: 2;
}


/* ============================================ */
/* ПОЛЯ ВВЕДЕННЯ                               */
/* ============================================ */

.content-bloc input,
.content-bloc textarea,
.content-bloc select,
.content-line.panel input {
    border: none;
    padding: 0;
    background-color: transparent;
    width: 100%;
    resize: vertical;
    font-family: inherit;
    color: var(--color-on-surface);
}

.content-bloc input,
.content-bloc select,
.content-line.panel input,
.content-line.panel select {
    height: 40px;
}

.content-bloc textarea {
    padding: 10px 16px 0 16px;
    min-height: 40px;
}

/* Input всередині .panel без зайвого padding (бо .panel вже має padding) */
.content-line.panel > input {
    padding: 0;
}


/* В textarea — тег фіксовано у верхньому правому куті */
.input-box:has(textarea) {
    position: relative;
}

.input-box:has(textarea) .tag {
    position: absolute;
    top: 12px;
    right: 4px;
}


/* ============================================ */
/* ВІЗУАЛІЗАЦІЯ РЯДКІВ                         */
/* ============================================ */

/* Злиття borders між послідовними рядками (не через розділювач) */
.content-bloc:not(.new-table):not(.h3) + .content-bloc:not(.new-table):not(.h3) .content-line {
    border-top: none;
}

/* Відновити border-top і повне заокруглення в spaced контейнерах */
.content-bloc-container.spaced > .content-bloc + .content-bloc .content-line {
    border-top: 1px solid var(--color-outline);
}

.content-bloc-container.spaced > .content-bloc .content-line {
    border-radius: 8px;
}

/* Звичайний рядок */
.td .content-line {
    background-color: transparent;
}

/* Заголовок (світлий) */
.th .content-line {
    background-color: var(--color-surface-c-low);
}

/* Заголовок (темніший, жирний) */
.th-strong .content-line {
    background-color: var(--color-surface-c);
}

/* H3 — без рамки */
.h3 .content-line {
    border: none;
    padding: 8px 0;
}


/* ============================================ */
/* СТИЛІ ТЕКСТУ                                */
/* ============================================ */

.content-bloc.bold input,
.content-bloc.bold textarea,
.content-bloc.th-strong input,
.content-bloc.th-strong textarea {
    font-weight: 700;
}

.content-bloc.italic input,
.content-bloc.italic textarea {
    font-style: italic;
}

.content-bloc.h3 .input-box input,
.content-bloc.h3 .input-box textarea {
    font-family: 'NyghtSerif', serif;
    font-size: 20px;
    font-weight: 600;
    line-height: 1.4;
}

.content-bloc.added input,
.content-bloc.added textarea {
    color: var(--color-main);
}

/* ============================================ */
/* ПРИХОВУВАННЯ МАЛИХ INPUT-BOX                */
/* ============================================ */

/* Розділювач всередині content-line — трохи коротший за повну висоту */
.content-line > .separator-v {
    align-self: stretch;
    margin: 8px 0;
}

:is(.h3, .single, .colspan2) .input-box.small,
:is(.h3, .single, .colspan2) > .content-line > .separator-v {
    display: none;
}


/* ============================================ */
/* РОЗДІЛЮВАЧ ТАБЛИЦЬ                          */
/* ============================================ */

.new-table .content-line {
    visibility: hidden;
}


/* ============================================ */
/* BORDER RADIUS                               */
/* ============================================ */

/* За замовчуванням — повне заокруглення (працює для одиночних блоків) */
.content-bloc .content-line {
    border-radius: 8px;
}

/* Є наступний рядок → прибрати нижнє заокруглення */
.content-bloc:not(.new-table):not(.h3):has(+ .content-bloc:not(.new-table):not(.h3)) .content-line {
    border-radius: 8px 8px 0 0;
}

/* Є попередній рядок → прибрати верхнє заокруглення */
.content-bloc:not(.new-table):not(.h3) + .content-bloc:not(.new-table):not(.h3) .content-line {
    border-radius: 0 0 8px 8px;
}

/* Є і попередній, і наступний → без заокруглення */
.content-bloc:not(.new-table):not(.h3) + .content-bloc:not(.new-table):not(.h3):has(+ .content-bloc:not(.new-table):not(.h3)) .content-line {
    border-radius: 0;
}

/* .panel завжди має повне заокруглення */
.content-line.panel {
    border-radius: 8px;
}


/* ============================================ */
/* ТЕКСТОВИЙ РЕЖИМ (для related items)         */
/* ============================================ */

/* Назва елемента */
.content-bloc .item-name {
    padding: 0 12px;
    height: 40px;
    display: flex;
    align-items: center;
    color: var(--color-on-surface);
}

/* ID елемента */
.content-bloc .item-id {
    padding: 0 12px;
    height: 40px;
    display: flex;
    align-items: center;
    color: var(--color-on-surface-v);
    font-family: var(--font-mono);
}


/* ============================================ */
/* PANEL-CONTENT-FIX (фіксований контент)      */
/* ============================================ */

.panel-content-fix {
    flex-shrink: 0;
}
