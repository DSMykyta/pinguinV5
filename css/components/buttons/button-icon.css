/**
 * COMPONENT: Icon Button
 *
 * ПРИЗНАЧЕННЯ:
 * Кругла кнопка з іконкою для швидких дій (закрити, меню, інформація, редагувати).
 * Мінімалістичний дизайн без тексту, тільки іконка Material Symbols.
 *
 * ВИКОРИСТАННЯ:
 * Використовується для дій де іконка сама по собі зрозуміла без тексту.
 * Обов'язково додавайте aria-label для доступності.
 *
 * HTML ПРИКЛАД:
 * <button class="btn-icon" aria-label="Закрити">
 *   <span class="material-symbols-outlined">close</span>
 * </button>
 *
 * <button class="btn-icon ghost" aria-label="Перемістити">
 *   <span class="material-symbols-outlined">drag_handle</span>
 * </button>
 *
 * КЛАСИ:
 * - .btn-icon - базовий клас (32x32px, круглий, hover з фоном)
 * - .btn-icon:hover - стан наведення (фон, тінь)
 * - .btn-icon.active / .active - активний стан
 *
 * ЧАРМИ (charms):
 * - .ghost - без фону при hover, тільки зміна кольору
 * - .touch - збільшена тач-ціль 44×44px
 * - .reload - приглушений колір, нейтральний hover (surface-c-high)
 * - .drag - cursor: grab/grabbing для drag-handle кнопок
 * - .reveal - прихована, з'являється при hover на батьківський елемент
 * - .danger - hover червоним (error-c фон, error колір)
 * - .expand - розкриття label тексту на hover (max-width трік)
 *
 * ЗАЛЕЖНОСТІ:
 * - root.css (--color-main, --color-on-surface-v, --color-surface-c-high, --transition-speed)
 * - Material Symbols (для іконок)
 *
 * ЗАСТОСУВАННЯ:
 * - Modal header (кнопка закриття)
 * - Panel header (згортання панелі)
 * - Table actions (редагувати, видалити)
 * - Навігація (back, forward)
 * - Drag handles (ghost + drag)
 * - Tree toggles (ghost)
 * - Section reload (reload)
 * - Row hidden actions (reveal)
 */

.btn-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;

    padding: 0;
    min-width: 32px;
    height: 32px;

    background-color: transparent;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    text-decoration: none;

    color: inherit;

    backdrop-filter: var(--blur-m);
    transition: background-color var(--transition-speed);
}

.btn-icon:hover,
.btn-icon.active {
    background-color: color-mix(in srgb, var(--color-main) 20%, transparent);
    border-color: var(--color-main);
    color: var(--color-main);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.btn-icon .material-symbols-outlined {
    font-size: 16px;
}

/* Чарм: ghost — без фону, тільки зміна кольору */
.btn-icon.ghost {
    color: var(--color-outline);
}

.btn-icon.ghost:hover {
    background-color: transparent;
    border-color: transparent;
    color: var(--color-on-surface);
    box-shadow: none;
}

/* Чарм: drag — cursor grab для перетягування */
.btn-icon.drag {
    cursor: grab;
}

.btn-icon.drag:active {
    cursor: grabbing;
}

/* Чарм: reveal — прихована, з'являється при hover батька */
.btn-icon.reveal {
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--transition-speed), visibility var(--transition-speed);
}

*:hover > .btn-icon.reveal {
    opacity: 1;
    visibility: visible;
}

/* Чарм: touch — збільшена тач-ціль 44×44 */
.btn-icon.touch {
    min-width: 44px;
    height: 44px;
}

.btn-icon.touch .material-symbols-outlined {
    font-size: 22px;
}

/* Чарм: tilt — поворот іконки 45° при .open (+ → ×) */
.btn-icon.tilt .material-symbols-outlined {
    display: inline-block;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.btn-icon.tilt.open .material-symbols-outlined {
    transform: rotate(45deg);
}

/* Чарм: rotate — поворот іконки 90° при .open */
.btn-icon.rotate .material-symbols-outlined {
    display: inline-block;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.btn-icon.rotate.open .material-symbols-outlined {
    transform: rotate(90deg);
}

/* Чарм: flip — поворот іконки 180° при .open (chevron → ←) */
.btn-icon.flip .material-symbols-outlined {
    display: inline-block;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.btn-icon.flip.open .material-symbols-outlined {
    transform: rotate(180deg);
}

/* Чарм: large — розмір FAB 56×56 */
.btn-icon.large {
    min-width: 56px;
    height: 56px;
}

.btn-icon.large .material-symbols-outlined {
    font-size: 24px;
}

/* Чарм: reload — перезавантаження секції */
.btn-icon.reload {
    color: var(--color-on-surface-v);
}

.btn-icon.reload:hover {
    background: var(--color-surface-c-high);
}


/* Чарм: danger — hover червоним для деструктивних дій */
.btn-icon.danger:hover {
    background-color: var(--color-error-c);
    color: var(--color-error);
    border-color: transparent;
    box-shadow: none;
}


/* Чарм: expand — розкриття label тексту на hover */
.btn-icon.expand {
    justify-content: start;
    padding: 8px;
    gap: 8px;
    max-width: 32px;
    overflow: hidden;
    border-radius: var(--radius-full);
    color: inherit;
    transition: max-width 0.55s ease,
                padding 0.3s ease,
                background-color 0.5s ease,
                color 0.5s ease;
}

.btn-icon.expand.active {
    background-color: var(--color-main-c);
    color: var(--color-main);
}

.btn-icon.expand:hover {
    background-color: var(--color-main-c);
    color: var(--color-main);
    max-width: 400px;
    padding-right: 16px;
    box-shadow: none;
}

/* expand + touch: іконка нерухома, кнопка росте вправо */
.btn-icon.expand.touch {
    max-width: 44px;
    padding: 14px;
}

.btn-icon.expand.touch:hover {
    max-width: 400px;
    padding-left: 14px;
    padding-right: 16px;
    gap: 12px;
}

.btn-icon-label {
    max-width: 0;
    overflow: hidden;
    opacity: 0;
    white-space: nowrap;
    transition: opacity 0.5s ease 0.1s,
                max-width 0.55s ease,
                margin 0.55s ease;
}

.btn-icon.expand:hover .btn-icon-label {
    max-width: 200px;
    opacity: 1;
    transition: opacity 0.2s ease 0.1s,
                max-width 0.55s ease,
                margin 0.55s ease;
}

/* Лічильники всередині expand — менші та блякліші */
.btn-icon.expand > span:not(.material-symbols-outlined):not(.btn-icon-label) {
    font-size: 11px;
    opacity: 0.5;
    transition: font-size 0.3s ease, opacity 0.3s ease;
}

.btn-icon.expand:hover > span:not(.material-symbols-outlined):not(.btn-icon-label) {
    font-size: 14px;
    opacity: 1;
}
