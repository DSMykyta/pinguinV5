<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Data Contract — pinguin-v5</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" />
    <script src="../js/theme-init.js"></script>
    <style>
        * { font-size: revert; }

        body {
            display: flex !important;
            flex-direction: row !important;
            height: 100dvh !important;
            overflow: hidden !important;
            scroll-snap-type: none !important;
            padding: 0 !important;
            margin: 0 !important;
            max-width: none !important;
            background: var(--color-surface);
        }

        section {
            height: auto !important;
            min-height: auto !important;
            scroll-snap-align: none !important;
            overflow: visible !important;
        }

        .content-main, .nav.column, .section-navigator { display: none !important; }

        /* SIDEBAR */
        .m3-sidebar {
            width: 260px;
            min-width: 260px;
            height: 100dvh;
            overflow-y: auto;
            background: var(--color-surface-c-low);
            border-right: 1px solid var(--color-outline);
            padding: 24px 16px;
            position: sticky;
            top: 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .m3-sidebar-title {
            font-size: 22px;
            font-weight: 600;
            padding: 8px 12px 20px;
            color: var(--color-on-surface);
            border-bottom: 1px solid var(--color-outline);
            margin-bottom: 12px;
        }
        .m3-sidebar-title span {
            font-size: 12px;
            font-weight: 400;
            color: var(--color-on-surface-v);
            display: block;
            margin-top: 2px;
        }
        .m3-nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: var(--radius-full);
            color: var(--color-on-surface);
            text-decoration: none;
            font-size: 13px;
            font-weight: 400;
            transition: all 0.15s;
            cursor: pointer;
        }
        .m3-nav-item:hover { background: var(--color-surface-c); }
        .m3-nav-item.active {
            background: var(--color-main-c);
            color: var(--color-main);
            font-weight: 600;
        }
        .m3-nav-item .material-symbols-outlined { font-size: 20px; }

        /* MAIN */
        .m3-main { flex: 1; overflow-y: auto; padding: 0; }
        .m3-content { max-width: 960px; margin: 0 auto; padding: 40px 48px 80px; }

        /* HERO */
        .m3-hero {
            background: linear-gradient(135deg, var(--color-main) 0%, var(--color-secondary) 100%);
            border-radius: 28px;
            padding: 48px;
            margin-bottom: 40px;
            color: var(--color-on-main);
        }
        .m3-hero h1 { font-size: 40px; font-weight: 400; margin: 0 0 8px; color: inherit; }
        .m3-hero p { font-size: 16px; opacity: 0.85; margin: 0; max-width: 600px; line-height: 1.5; }

        /* SECTION */
        .m3-section { margin-bottom: 56px; scroll-margin-top: 24px; }
        .m3-section-title { font-size: 28px; font-weight: 400; color: var(--color-on-surface); margin: 0 0 8px; }
        .m3-section-desc {
            font-size: 14px;
            color: var(--color-on-surface-v);
            margin: 0 0 24px;
            line-height: 1.6;
            max-width: 640px;
        }

        /* BLOCK */
        .m3-block {
            margin-bottom: 32px;
            border: 1px solid var(--color-outline);
            border-radius: 16px;
            overflow: hidden;
            background: var(--color-surface);
        }
        .m3-block-header {
            padding: 20px 24px 16px;
            border-bottom: 1px solid var(--color-outline);
        }
        .m3-block-header h3 { font-size: 16px; font-weight: 600; margin: 0 0 4px; color: var(--color-on-surface); }
        .m3-block-header p { font-size: 13px; color: var(--color-on-surface-v); margin: 0; line-height: 1.5; }

        /* SPEC TABLE */
        .m3-spec { width: 100%; border-collapse: collapse; font-size: 13px; }
        .m3-spec th {
            text-align: left;
            padding: 10px 16px;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--color-on-surface-v);
            background: var(--color-surface-c-low);
            border-bottom: 1px solid var(--color-outline);
        }
        .m3-spec td {
            padding: 10px 16px;
            border-bottom: 1px solid var(--color-outline);
            color: var(--color-on-surface);
        }
        .m3-spec tr:last-child td { border-bottom: none; }
        .m3-spec code {
            font-family: 'Roboto Mono', monospace;
            font-size: 11px;
            background: var(--color-surface-c);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* CODE BLOCKS */
        .m3-code {
            padding: 16px 24px;
            border-top: 1px solid var(--color-outline);
            background: var(--color-surface-c-low);
            overflow-x: auto;
        }
        .m3-code-label {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--color-main);
            margin-bottom: 10px;
        }
        .m3-code pre {
            margin: 0;
            font-family: 'Roboto Mono', 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.75;
            color: var(--color-on-surface);
            white-space: pre;
        }

        /* PART DIVIDERS */
        .m3-part {
            display: flex;
            align-items: center;
            gap: 14px;
            margin: 48px 0 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--color-outline);
        }
        .m3-part:first-of-type { margin-top: 0; }
        .m3-part-icon { font-size: 22px; color: var(--color-main); }
        .m3-part-title { font-size: 20px; font-weight: 600; color: var(--color-on-surface); flex: 1; }
        .m3-part-badge {
            font-size: 11px;
            font-weight: 600;
            padding: 3px 10px;
            border-radius: 100px;
            letter-spacing: 0.03em;
        }
        .m3-part-badge.global {
            background: color-mix(in srgb, var(--color-secondary) 20%, transparent);
            color: var(--color-secondary, #7b5ea7);
        }
        .m3-part-badge.removable {
            background: var(--color-main-c);
            color: var(--color-main);
        }

        /* SCROLLBAR */
        .m3-sidebar::-webkit-scrollbar, .m3-main::-webkit-scrollbar { width: 4px; }
        .m3-sidebar::-webkit-scrollbar-thumb, .m3-main::-webkit-scrollbar-thumb {
            background: var(--color-outline);
            border-radius: 4px;
        }

        /* THEME TOGGLE */
        .m3-theme-toggle { position: fixed; bottom: 24px; right: 24px; z-index: 9999; }
    </style>
</head>

<body>

<!-- SIDEBAR -->
<aside class="m3-sidebar">
    <div class="m3-sidebar-title">
        API Contract
        <span>Data sources & endpoints</span>
    </div>
    <a class="m3-nav-item" href="#overview">
        <span class="material-symbols-outlined">overview</span> Overview
    </a>
    <a class="m3-nav-item" href="#brands">
        <span class="material-symbols-outlined">shopping_bag</span> Brands
    </a>
    <a class="m3-nav-item" href="#brand-lines">
        <span class="material-symbols-outlined">account_tree</span> Brand Lines
    </a>
    <a class="m3-nav-item" href="#banned-words">
        <span class="material-symbols-outlined">block</span> Banned Words
    </a>
    <a class="m3-nav-item" href="#glossary">
        <span class="material-symbols-outlined">import_contacts</span> Glossary / Keywords
    </a>
    <a class="m3-nav-item" href="#mapper">
        <span class="material-symbols-outlined">hub</span> Mapper
    </a>
    <a class="m3-nav-item" href="#price">
        <span class="material-symbols-outlined">receipt_long</span> Price
    </a>
    <a class="m3-nav-item" href="#texts">
        <span class="material-symbols-outlined">description</span> Texts DB
    </a>
    <a class="m3-nav-item" href="#generators">
        <span class="material-symbols-outlined">auto_fix_high</span> Generators
    </a>
    <a class="m3-nav-item" href="#operations">
        <span class="material-symbols-outlined">sync_alt</span> Operations
    </a>
</aside>

<!-- MAIN -->
<main class="m3-main">
<div class="m3-content">

    <!-- HERO -->
    <div class="m3-hero">
        <h1>API Data Contract</h1>
        <p>Повний опис структури даних, ендпоінтів та операцій. Фронтенд приймає JSON-масиви об'єктів &mdash; джерело даних (Google Sheets чи SQL) не має значення.</p>
    </div>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- OVERVIEW -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="overview">
        <h2 class="m3-section-title">Overview</h2>
        <p class="m3-section-desc">
            Фронтенд працює з масивами об'єктів <code>[{id, name, ...}]</code>.
            Зараз дані приходять з Google Sheets API. Для міграції на SQL бекенд потрібно реалізувати REST API з аналогічною структурою відповідей.
        </p>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Databases (Google Sheets)</h3>
                <p>Три окремі таблиці-бази даних</p>
            </div>
            <table class="m3-spec">
                <tr><th>Database</th><th>Sheets</th><th>Auth</th></tr>
                <tr>
                    <td><code>MAIN</code></td>
                    <td>Brands, BrandLines, Banned, Glossary, Mapper_*</td>
                    <td>CSV (read) + API (write)</td>
                </tr>
                <tr>
                    <td><code>TEXTS</code></td>
                    <td>Dynamic sheets (product text collections)</td>
                    <td>API only</td>
                </tr>
                <tr>
                    <td><code>PRICE</code></td>
                    <td>Price (single sheet)</td>
                    <td>API only</td>
                </tr>
            </table>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Summary Table</h3>
                <p>Всі ендпоінти та їх колонки</p>
            </div>
            <table class="m3-spec">
                <tr><th>Endpoint</th><th>Sheet</th><th>Columns</th><th>CRUD</th></tr>
                <tr><td><code>GET /api/brands</code></td><td>Brands</td><td>9 (A-I)</td><td>CRUD</td></tr>
                <tr><td><code>GET /api/brand-lines</code></td><td>BrandLines</td><td>4 (A-D)</td><td>CRUD</td></tr>
                <tr><td><code>GET /api/banned-words</code></td><td>Banned</td><td>9 (A-I)</td><td>CRUD</td></tr>
                <tr><td><code>GET /api/glossary</code></td><td>Glossary</td><td>13 (A-M)</td><td>CRUD</td></tr>
                <tr><td><code>GET /api/mapper/*</code></td><td>Mapper_*</td><td>4-14</td><td>CRUD</td></tr>
                <tr><td><code>GET /api/price</code></td><td>Price</td><td>16 (dynamic)</td><td>Read + Update</td></tr>
                <tr><td><code>GET /api/texts/*</code></td><td>Dynamic</td><td>Dynamic</td><td>Read + Update</td></tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- BRANDS -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="brands">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">shopping_bag</span>
            <span class="m3-part-title">Brands</span>
            <span class="m3-part-badge removable">CRUD</span>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>GET /api/brands</h3>
                <p>Sheet: <code>Brands</code> &bull; File: <code>js/pages/brands/brands-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Column</th><th>Field</th><th>Type</th><th>Description</th></tr>
                <tr><td>A</td><td><code>brand_id</code></td><td>string</td><td>ID format: <code>bran-XXXXXX</code></td></tr>
                <tr><td>B</td><td><code>name_uk</code></td><td>string</td><td>Ukrainian name</td></tr>
                <tr><td>C</td><td><code>names_alt</code></td><td>JSON array | string</td><td>Alternative names: <code>["Name1", "Name2"]</code> or comma-separated</td></tr>
                <tr><td>D</td><td><code>country_option_id</code></td><td>string</td><td>Country name</td></tr>
                <tr><td>E</td><td><code>brand_text</code></td><td>HTML string</td><td>Brand description (rich text)</td></tr>
                <tr><td>F</td><td><code>brand_status</code></td><td>string</td><td><code>active</code> | <code>inactive</code></td></tr>
                <tr><td>G</td><td><code>brand_links</code></td><td>JSON array</td><td><code>[{name: "ua", url: "https://..."}]</code></td></tr>
                <tr><td>H</td><td><code>mapper_option_id</code></td><td>string</td><td>Reserved for Mapper integration</td></tr>
                <tr><td>I</td><td><code>brand_logo_url</code></td><td>string</td><td>Logo URL (reserved)</td></tr>
            </table>
            <div class="m3-code">
                <div class="m3-code-label">Response example</div>
<pre>[
  {
    "brand_id": "bran-000001",
    "name_uk": "CeraVe",
    "names_alt": ["Церав", "СераВе"],
    "country_option_id": "США",
    "brand_text": "&lt;p&gt;Бренд дерматологічної косметики&lt;/p&gt;",
    "brand_status": "active",
    "brand_links": [{"name": "ua", "url": "https://cerave.ua"}],
    "mapper_option_id": "",
    "brand_logo_url": ""
  }
]</pre>
            </div>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Operations</h3>
            </div>
            <table class="m3-spec">
                <tr><th>Method</th><th>Function</th><th>Description</th></tr>
                <tr><td><code>POST</code></td><td><code>addBrand(brandData)</code></td><td>Append new row</td></tr>
                <tr><td><code>PUT</code></td><td><code>updateBrand(brandId, updates)</code></td><td>Update by row index</td></tr>
                <tr><td><code>DELETE</code></td><td><code>deleteBrand(brandId)</code></td><td>Hard delete row</td></tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- BRAND LINES -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="brand-lines">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">account_tree</span>
            <span class="m3-part-title">Brand Lines</span>
            <span class="m3-part-badge removable">CRUD</span>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>GET /api/brand-lines</h3>
                <p>Sheet: <code>BrandLines</code> &bull; File: <code>js/pages/brands/lines-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Column</th><th>Field</th><th>Type</th><th>Description</th></tr>
                <tr><td>A</td><td><code>line_id</code></td><td>string</td><td>ID format: <code>line-XXXXXX</code></td></tr>
                <tr><td>B</td><td><code>brand_id</code></td><td>string</td><td>FK to Brands</td></tr>
                <tr><td>C</td><td><code>name_uk</code></td><td>string</td><td>Line name</td></tr>
                <tr><td>D</td><td><code>line_logo_url</code></td><td>string</td><td>Logo URL</td></tr>
            </table>
            <div class="m3-code">
                <div class="m3-code-label">Response example</div>
<pre>[
  {
    "line_id": "line-000001",
    "brand_id": "bran-000001",
    "name_uk": "CeraVe Moisturizers",
    "line_logo_url": ""
  }
]</pre>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- BANNED WORDS -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="banned-words">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">block</span>
            <span class="m3-part-title">Banned Words</span>
            <span class="m3-part-badge removable">CRUD</span>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>GET /api/banned-words</h3>
                <p>Sheet: <code>Banned</code> &bull; File: <code>js/pages/banned-words/banned-words-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Column</th><th>Field</th><th>Type</th><th>Description</th></tr>
                <tr><td>A</td><td><code>local_id</code></td><td>string</td><td>ID format: <code>ban-XXXXXX</code></td></tr>
                <tr><td>B</td><td><code>group_name_ua</code></td><td>string</td><td>Group name (UA)</td></tr>
                <tr><td>C</td><td><code>name_uk</code></td><td>string</td><td>Ukrainian words, comma-separated</td></tr>
                <tr><td>D</td><td><code>name_ru</code></td><td>string</td><td>Russian words, comma-separated</td></tr>
                <tr><td>E</td><td><code>banned_type</code></td><td>string</td><td>Type of ban</td></tr>
                <tr><td>F</td><td><code>banned_explaine</code></td><td>string</td><td>Explanation</td></tr>
                <tr><td>G</td><td><code>banned_hint</code></td><td>string</td><td>Hint for users</td></tr>
                <tr><td>H</td><td><code>severity</code></td><td>string</td><td><code>low</code> | <code>medium</code> | <code>high</code></td></tr>
                <tr><td>I</td><td><code>cheaked_line</code></td><td>string</td><td><code>TRUE</code> | <code>FALSE</code></td></tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- GLOSSARY / KEYWORDS -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="glossary">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">import_contacts</span>
            <span class="m3-part-title">Glossary / Keywords</span>
            <span class="m3-part-badge removable">CRUD</span>
        </div>

        <p class="m3-section-desc">
            Glossary та Keywords &mdash; це одна таблиця <code>Glossary</code>, яка використовується двома сторінками з різними наборами колонок. Glossary будує tree-структуру через <code>parent_local_id</code>.
        </p>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>GET /api/glossary</h3>
                <p>Sheet: <code>Glossary</code> &bull; Files: <code>glossary-data.js</code>, <code>keywords-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Column</th><th>Field</th><th>Type</th><th>Description</th></tr>
                <tr><td>A</td><td><code>local_id</code></td><td>string</td><td>ID format: <code>glo-XXXXXX</code></td></tr>
                <tr><td>B</td><td><code>param_type</code></td><td>string</td><td>Parameter type</td></tr>
                <tr><td>C</td><td><code>parent_local_id</code></td><td>string</td><td>Parent ID (for tree hierarchy)</td></tr>
                <tr><td>D</td><td><code>entity_identity_id</code></td><td>string</td><td>Entity identity</td></tr>
                <tr><td>E</td><td><code>name_uk</code></td><td>string</td><td>Ukrainian name</td></tr>
                <tr><td>F</td><td><code>name_ru</code></td><td>string</td><td>Russian name</td></tr>
                <tr><td>G</td><td><code>name_en</code></td><td>string</td><td>English name</td></tr>
                <tr><td>H</td><td><code>name_lat</code></td><td>string</td><td>Latin name</td></tr>
                <tr><td>I</td><td><code>name_alt</code></td><td>string</td><td>Alternative names</td></tr>
                <tr><td>J</td><td><code>trigers</code></td><td>string</td><td>Triggers, comma-separated</td></tr>
                <tr><td>K</td><td><code>keywords_ua</code></td><td>string</td><td>Ukrainian keywords, comma-separated</td></tr>
                <tr><td>L</td><td><code>keywords_ru</code></td><td>string</td><td>Russian keywords, comma-separated</td></tr>
                <tr><td>M</td><td><code>glossary_text</code></td><td>HTML string</td><td>Article text (rich text)</td></tr>
            </table>
            <div class="m3-code">
                <div class="m3-code-label">Tree structure (built on frontend)</div>
<pre>// glossaryTree = { parentId: [children] }
// glossaryMap  = { id: itemData }
// Корневі елементи: parent_local_id === "" або undefined</pre>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- MAPPER -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="mapper">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">hub</span>
            <span class="m3-part-title">Mapper</span>
            <span class="m3-part-badge global">9 sheets</span>
        </div>

        <p class="m3-section-desc">
            Mapper &mdash; система маппінгу власних сутностей (Categories, Characteristics, Options) на сутності маркетплейсів (MP_*). Зв'язки зберігаються в Map_* таблицях.
        </p>

        <!-- OWN ENTITIES -->
        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Own Entities</h3>
                <p>Власні сутності системи</p>
            </div>
            <table class="m3-spec">
                <tr><th>Endpoint</th><th>Sheet</th><th>ID prefix</th><th>Key fields</th></tr>
                <tr>
                    <td><code>GET /api/mapper/marketplaces</code></td>
                    <td>Mapper_Marketplaces</td>
                    <td><code>mp-</code></td>
                    <td>id, name, slug, is_active, field_schema, column_mapping, created_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/categories</code></td>
                    <td>Mapper_Categories</td>
                    <td><code>cat-</code></td>
                    <td>id, name_ua, name_ru, parent_id, grouping, created_at, updated_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/characteristics</code></td>
                    <td>Mapper_Characteristics</td>
                    <td><code>char-</code></td>
                    <td>id, id_directory, name_ua, name_ru, type, unit, filter_type, is_global, category_ids, block_number, created_at, sort_order, col_size, hint</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/options</code></td>
                    <td>Mapper_Options</td>
                    <td><code>opt-</code></td>
                    <td>id, id_directory, characteristic_id, value_ua, value_ru, sort_order, parent_option_id, created_at</td>
                </tr>
            </table>
        </div>

        <!-- MP ENTITIES -->
        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Marketplace Entities</h3>
                <p>Сутності з маркетплейсів (імпортовані)</p>
            </div>
            <table class="m3-spec">
                <tr><th>Endpoint</th><th>Sheet</th><th>Key fields</th></tr>
                <tr>
                    <td><code>GET /api/mapper/mp-categories</code></td>
                    <td>Mapper_MP_Categories</td>
                    <td>id, marketplace_id, external_id, name, data (JSON), type, created_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/mp-characteristics</code></td>
                    <td>Mapper_MP_Characteristics</td>
                    <td>id, marketplace_id, external_id, name, data (JSON), created_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/mp-options</code></td>
                    <td>Mapper_MP_Options</td>
                    <td>id, marketplace_id, external_id, name, data (JSON), created_at</td>
                </tr>
            </table>
        </div>

        <!-- MAPPINGS -->
        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Mapping Tables</h3>
                <p>Зв'язки між власними та MP сутностями (many-to-many)</p>
            </div>
            <table class="m3-spec">
                <tr><th>Endpoint</th><th>Sheet</th><th>Fields</th></tr>
                <tr>
                    <td><code>GET /api/mapper/map-categories</code></td>
                    <td>Mapper_Map_Categories</td>
                    <td>id, category_id, mp_category_id, created_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/map-characteristics</code></td>
                    <td>Mapper_Map_Characteristics</td>
                    <td>id, characteristic_id, mp_characteristic_id, created_at</td>
                </tr>
                <tr>
                    <td><code>GET /api/mapper/map-options</code></td>
                    <td>Mapper_Map_Options</td>
                    <td>id, option_id, mp_option_id, created_at</td>
                </tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- PRICE -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="price">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">receipt_long</span>
            <span class="m3-part-title">Price / Checklist</span>
            <span class="m3-part-badge removable">Read + Update</span>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>GET /api/price</h3>
                <p>Sheet: <code>Price</code> (PRICE DB) &bull; File: <code>js/pages/price/price-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Field</th><th>Type</th><th>Description</th></tr>
                <tr><td><code>code</code></td><td>string</td><td>Unique product code (PK)</td></tr>
                <tr><td><code>article</code></td><td>string</td><td>Article number</td></tr>
                <tr><td><code>brand</code></td><td>string</td><td>Brand name</td></tr>
                <tr><td><code>category</code></td><td>string</td><td>Product category</td></tr>
                <tr><td><code>name</code></td><td>string</td><td>Product name</td></tr>
                <tr><td><code>packaging</code></td><td>string</td><td>Packaging info</td></tr>
                <tr><td><code>flavor</code></td><td>string</td><td>Flavor / variant</td></tr>
                <tr><td><code>shiping_date</code></td><td>string</td><td>Shipping date or "ненаявно"</td></tr>
                <tr><td><code>reserve</code></td><td>string</td><td>Reserved by user (display_name)</td></tr>
                <tr><td><code>status</code></td><td>boolean</td><td>Status flag</td></tr>
                <tr><td><code>status_date</code></td><td>string</td><td>Date status changed</td></tr>
                <tr><td><code>check</code></td><td>boolean</td><td>Check flag</td></tr>
                <tr><td><code>check_date</code></td><td>string</td><td>Date checked</td></tr>
                <tr><td><code>payment</code></td><td>boolean</td><td>Payment flag</td></tr>
                <tr><td><code>payment_date</code></td><td>string</td><td>Date paid</td></tr>
                <tr><td><code>update_date</code></td><td>string</td><td>Last update date</td></tr>
            </table>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Operations</h3>
            </div>
            <table class="m3-spec">
                <tr><th>Method</th><th>Function</th><th>Description</th></tr>
                <tr><td><code>PUT</code></td><td><code>updateItemStatus(code, field, value)</code></td><td>Update status/check/payment + auto-date</td></tr>
                <tr><td><code>PUT</code></td><td><code>updateItemArticle(code, article)</code></td><td>Update article number</td></tr>
                <tr><td><code>PUT</code></td><td><code>reserveItem(code, reserveName)</code></td><td>Set reserve</td></tr>
                <tr><td><code>PUT</code></td><td><code>updateItemFields(code, fields)</code></td><td>Update multiple fields</td></tr>
                <tr><td><code>POST</code></td><td><code>importDataToSheet(data)</code></td><td>Bulk import from XLSX</td></tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- TEXTS DB -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="texts">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">description</span>
            <span class="m3-part-title">Texts Database</span>
            <span class="m3-part-badge global">Dynamic</span>
        </div>

        <p class="m3-section-desc">
            Texts DB &mdash; колекція таблиць з текстами товарів. Кожна таблиця (sheet) &mdash; окрема колекція. Headers визначаються динамічно. Використовується для перевірки заборонених слів.
        </p>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Dynamic Endpoints</h3>
                <p>File: <code>js/pages/banned-words/banned-words-data.js</code></p>
            </div>
            <table class="m3-spec">
                <tr><th>Method</th><th>Function</th><th>Description</th></tr>
                <tr><td><code>GET</code></td><td><code>loadSheetNames()</code></td><td>List all sheet names in Texts DB</td></tr>
                <tr><td><code>GET</code></td><td><code>getSheetHeaders(sheetName)</code></td><td>Get column headers dynamically</td></tr>
                <tr><td><code>GET</code></td><td><code>loadSheetColumn(sheet, column)</code></td><td>Load specific column + ID</td></tr>
                <tr><td><code>GET</code></td><td><code>loadSheetDataForCheck(sheet, col)</code></td><td>Load id, title, cheaked_line, target column</td></tr>
                <tr><td><code>GET</code></td><td><code>loadProductFullData(sheet, rowIdx)</code></td><td>Load full product row</td></tr>
                <tr><td><code>PUT</code></td><td><code>updateProductStatus(sheet, id, col, val)</code></td><td>Update cheaked_line status</td></tr>
            </table>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- GENERATORS -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="generators">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">auto_fix_high</span>
            <span class="m3-part-title">Generators (Read-only)</span>
            <span class="m3-part-badge global">Derived</span>
        </div>

        <p class="m3-section-desc">
            Генератори не мають окремих таблиць &mdash; вони читають дані з Brands та Glossary і трансформують їх для своїх потреб.
        </p>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Link Generator</h3>
                <p>File: <code>js/generators/generator-link/gln-data.js</code></p>
            </div>
            <div class="m3-code">
                <div class="m3-code-label">Reads from Brands, transforms to</div>
<pre>linksData = [
  { brand: "CeraVe", linkName: "ua", url: "https://...", country: "США" }
]
countriesData = { "cerave": "США" }</pre>
            </div>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>SEO Generator</h3>
                <p>File: <code>js/generators/generator-seo/gse-data.js</code></p>
            </div>
            <div class="m3-code">
                <div class="m3-code-label">Reads from Glossary + Brands, transforms to</div>
<pre>triggersData = [
  { title: "Зволоження", triggers: ["зволожувач", "крем"], keywords: ["moisturizer"] }
]
brandsData = {
  "cerave": { country: "США", searchNames: ["CeraVe", "Церав", "СераВе"] }
}</pre>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════════ -->
    <!-- OPERATIONS -->
    <!-- ═══════════════════════════════════════════════════════════════ -->
    <section class="m3-section" id="operations">
        <div class="m3-part">
            <span class="material-symbols-outlined m3-part-icon">sync_alt</span>
            <span class="m3-part-title">Common Patterns</span>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>ID Generation</h3>
                <p>All IDs follow the pattern: <code>prefix-XXXXXX</code> (6-digit zero-padded)</p>
            </div>
            <table class="m3-spec">
                <tr><th>Prefix</th><th>Entity</th></tr>
                <tr><td><code>bran-</code></td><td>Brands</td></tr>
                <tr><td><code>line-</code></td><td>Brand Lines</td></tr>
                <tr><td><code>ban-</code></td><td>Banned Words</td></tr>
                <tr><td><code>glo-</code></td><td>Glossary / Keywords</td></tr>
                <tr><td><code>cat-</code></td><td>Mapper Categories</td></tr>
                <tr><td><code>char-</code></td><td>Mapper Characteristics</td></tr>
                <tr><td><code>opt-</code></td><td>Mapper Options</td></tr>
            </table>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Response Format</h3>
                <p>All endpoints should return JSON arrays of objects</p>
            </div>
            <div class="m3-code">
                <div class="m3-code-label">Expected format</div>
<pre>// GET /api/{entity}
[
  { "field1": "value1", "field2": "value2", ... },
  { "field1": "value3", "field2": "value4", ... }
]

// Each object includes _rowIndex (1-based, for updates)
// Frontend uses _rowIndex to identify rows for PUT/DELETE</pre>
            </div>
        </div>

        <div class="m3-block">
            <div class="m3-block-header">
                <h3>Data Layer Files (to replace)</h3>
                <p>Файли які потрібно адаптувати при міграції на SQL бекенд</p>
            </div>
            <table class="m3-spec">
                <tr><th>File</th><th>Purpose</th></tr>
                <tr><td><code>js/config/spreadsheet-config.js</code></td><td>Spreadsheet IDs &rarr; замінити на API base URL</td></tr>
                <tr><td><code>js/utils/api-client.js</code></td><td>Google Sheets API wrapper &rarr; замінити на fetch calls</td></tr>
                <tr><td><code>js/utils/google-sheets-batch.js</code></td><td>Batch operations &rarr; замінити на REST endpoints</td></tr>
                <tr><td><code>js/auth/auth-google.js</code></td><td>Google OAuth &rarr; замінити на свою авторизацію</td></tr>
                <tr><td><code>js/auth/auth-drive-token.js</code></td><td>Drive token management &rarr; видалити</td></tr>
            </table>
        </div>
    </section>

</div>
</main>

<!-- Theme toggle -->
<div class="m3-theme-toggle">
    <button id="theme-toggle-btn" class="btn-icon touch" onclick="
        const html = document.documentElement;
        html.hasAttribute('data-theme') ? html.removeAttribute('data-theme') : html.setAttribute('data-theme', 'dark');
    " aria-label="Theme">
        <span class="material-symbols-outlined" id="theme-toggle-icon">dark_mode</span>
    </button>
</div>

<!-- Sidebar navigation -->
<script>
document.querySelectorAll('.m3-nav-item').forEach(item => {
    item.addEventListener('click', e => {
        document.querySelectorAll('.m3-nav-item').forEach(i => i.classList.remove('active'));
        item.classList.add('active');
    });
});
// Highlight on scroll
const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            const id = entry.target.id;
            document.querySelectorAll('.m3-nav-item').forEach(i => {
                i.classList.toggle('active', i.getAttribute('href') === '#' + id);
            });
        }
    });
}, { threshold: 0.3 });
document.querySelectorAll('.m3-section').forEach(s => observer.observe(s));
</script>

</body>
</html>
